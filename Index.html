<!DOCTYPE html>

<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ì˜¤ëŠ˜ì˜ ì‹œí™© ë¸Œë¦¬í•‘</title>
<link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
<style>
  :root {
    --bg: #0d0f14;
    --surface: #161b24;
    --surface2: #1e2535;
    --border: rgba(255,255,255,0.07);
    --text: #f0f2f7;
    --muted: #8b93a8;
    --up: #ff5b5b;
    --down: #4c8ef7;
    --accent: #6366f1;
    --gold: #f59e0b;
  }
  * { margin:0; padding:0; box-sizing:border-box; }
  body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Pretendard', -apple-system, sans-serif;
    padding-bottom: 80px;
  }

/* API Key Banner */
.api-banner {
background: linear-gradient(135deg, #1a1d35, #1e2535);
border-bottom: 1px solid rgba(99,102,241,0.3);
padding: 12px 16px;
display: flex;
align-items: center;
gap: 10px;
position: sticky;
top: 0;
z-index: 200;
}
.api-banner-text { font-size: 12px; color: #a5b4fc; flex: 1; }
.api-banner-text strong { color: #fff; }
.api-key-input {
background: rgba(255,255,255,0.08);
border: 1px solid rgba(99,102,241,0.4);
border-radius: 8px;
padding: 6px 10px;
color: #fff;
font-size: 12px;
width: 160px;
outline: none;
font-family: monospace;
}
.api-key-input::placeholder { color: #555; }
.api-key-btn {
background: #6366f1;
border: none;
border-radius: 8px;
padding: 6px 12px;
color: #fff;
font-size: 12px;
font-weight: 700;
cursor: pointer;
white-space: nowrap;
}
.api-key-btn:hover { background: #4f46e5; }
.demo-badge {
background: rgba(245,158,11,0.15);
color: var(â€“gold);
font-size: 10px;
font-weight: 700;
padding: 2px 7px;
border-radius: 20px;
border: 1px solid rgba(245,158,11,0.3);
white-space: nowrap;
}
.live-badge {
background: rgba(74,222,128,0.15);
color: #4ade80;
font-size: 10px;
font-weight: 700;
padding: 2px 7px;
border-radius: 20px;
border: 1px solid rgba(74,222,128,0.3);
white-space: nowrap;
display: none;
}

.wrap { max-width: 480px; margin: 0 auto; padding: 0 16px; }

header { padding: 32px 0 20px; }
.header-date { font-size: 12px; color: var(â€“muted); letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 6px; }
.header-title { font-size: 24px; font-weight: 800; letter-spacing: -0.03em; }
.header-title span { background: linear-gradient(135deg, #6366f1, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
.header-sub { font-size: 13px; color: var(â€“muted); margin-top: 6px; }

/* Loading skeleton */
.skeleton {
background: linear-gradient(90deg, var(â€“surface) 25%, var(â€“surface2) 50%, var(â€“surface) 75%);
background-size: 200% 100%;
animation: shimmer 1.5s infinite;
border-radius: 8px;
}
@keyframes shimmer { 0% { background-position: 200% 0; } 100% { background-position: -200% 0; } }

/* Summary Card */
.summary-card {
background: linear-gradient(135deg, #1a1d35, #1e2535);
border: 1px solid rgba(99,102,241,0.25);
border-radius: 20px;
padding: 18px;
margin-bottom: 24px;
position: relative;
overflow: hidden;
}
.summary-card::before {
content: â€˜â€™;
position: absolute;
top: -30px; right: -30px;
width: 100px; height: 100px;
background: radial-gradient(circle, rgba(99,102,241,0.12), transparent 70%);
}
.summary-label {
display: flex; align-items: center; gap: 6px;
font-size: 11px; font-weight: 700; color: #818cf8;
letter-spacing: 0.08em; text-transform: uppercase; margin-bottom: 10px;
}
.ai-dot { width: 6px; height: 6px; background: #6366f1; border-radius: 50%; animation: pulse 2s infinite; }
@keyframes pulse { 0%,100%{opacity:1;transform:scale(1)} 50%{opacity:0.5;transform:scale(0.8)} }
.summary-text { font-size: 13px; line-height: 1.75; color: #c7d2fe; }
.summary-text strong { color: #fff; font-weight: 600; }

/* Section */
.section-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 10px; }
.section-title {
font-size: 12px; font-weight: 700; color: var(â€“muted);
letter-spacing: 0.06em; text-transform: uppercase;
display: flex; align-items: center; gap: 8px;
}
.section-title::before { content: â€˜â€™; width: 3px; height: 12px; background: var(â€“accent); border-radius: 2px; }
.refresh-btn {
font-size: 11px; color: var(â€“muted); cursor: pointer;
background: none; border: none; display: flex; align-items: center; gap: 4px;
padding: 4px 8px; border-radius: 8px; transition: background 0.15s;
}
.refresh-btn:hover { background: var(â€“surface2); color: var(â€“text); }
.spin { animation: spin 1s linear infinite; }
@keyframes spin { to { transform: rotate(360deg); } }

/* Index Grid */
.index-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-bottom: 24px; }
.index-card {
background: var(â€“surface); border: 1px solid var(â€“border);
border-radius: 16px; padding: 16px; cursor: pointer; transition: all 0.2s;
}
.index-card:hover { background: var(â€“surface2); transform: translateY(-1px); }
.index-name { font-size: 11px; color: var(â€“muted); font-weight: 500; margin-bottom: 6px; }
.index-value { font-size: 19px; font-weight: 700; letter-spacing: -0.02em; margin-bottom: 3px; }
.index-change { font-size: 12px; font-weight: 600; display: flex; align-items: center; gap: 3px; }
.up { color: var(â€“up); }
.down { color: var(â€“down); }
.neutral-c { color: var(â€“muted); }
.mini-chart { margin-top: 10px; height: 30px; width: 100%; }
.loading-bar { height: 30px; margin-top: 10px; border-radius: 6px; }

/* FX Grid */
.fx-row { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 24px; }
.fx-card {
background: var(â€“surface); border: 1px solid var(â€“border);
border-radius: 14px; padding: 14px 10px; text-align: center;
}
.fx-label { font-size: 10px; color: var(â€“muted); margin-bottom: 5px; font-weight: 600; letter-spacing: 0.05em; text-transform: uppercase; }
.fx-value { font-size: 15px; font-weight: 700; letter-spacing: -0.01em; margin-bottom: 3px; }
.fx-change { font-size: 11px; font-weight: 600; }

/* Real Estate */
.re-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 8px; margin-bottom: 24px; }
.re-card {
background: var(â€“surface); border: 1px solid var(â€“border);
border-radius: 14px; padding: 14px 10px; text-align: center;
}
.re-region { font-size: 11px; color: var(â€“muted); margin-bottom: 5px; }
.re-value { font-size: 15px; font-weight: 700; letter-spacing: -0.02em; margin-bottom: 3px; }
.re-sub { font-size: 11px; font-weight: 600; }

/* Stock List */
.stock-list {
background: var(â€“surface); border: 1px solid var(â€“border);
border-radius: 20px; overflow: hidden; margin-bottom: 24px;
}
.stock-item {
display: flex; align-items: center; padding: 13px 16px;
border-bottom: 1px solid var(â€“border); cursor: pointer; transition: background 0.15s;
}
.stock-item:last-child { border-bottom: none; }
.stock-item:hover { background: var(â€“surface2); }
.stock-rank { font-size: 12px; color: var(â€“muted); font-weight: 600; width: 18px; flex-shrink: 0; }
.stock-icon {
width: 34px; height: 34px; border-radius: 10px;
display: flex; align-items: center; justify-content: center;
font-size: 12px; font-weight: 800; margin: 0 10px 0 8px; flex-shrink: 0;
}
.stock-info { flex: 1; }
.stock-name { font-size: 13px; font-weight: 600; margin-bottom: 1px; }
.stock-ticker { font-size: 11px; color: var(â€“muted); }
.stock-price-wrap { text-align: right; }
.stock-price { font-size: 14px; font-weight: 700; margin-bottom: 2px; }
.stock-change { font-size: 11px; font-weight: 600; }

/* News */
.news-list { display: flex; flex-direction: column; gap: 8px; margin-bottom: 24px; }
.news-item {
background: var(â€“surface); border: 1px solid var(â€“border);
border-radius: 14px; padding: 13px 14px;
display: flex; align-items: flex-start; gap: 10px;
cursor: pointer; transition: background 0.15s;
}
.news-item:hover { background: var(â€“surface2); }
.news-tag {
font-size: 10px; font-weight: 700; padding: 3px 7px;
border-radius: 20px; white-space: nowrap; flex-shrink: 0; margin-top: 1px;
}
.tag-red { background: rgba(255,91,91,0.15); color: var(â€“up); }
.tag-blue { background: rgba(76,142,247,0.15); color: var(â€“down); }
.tag-gold { background: rgba(245,158,11,0.15); color: var(â€“gold); }
.tag-purple { background: rgba(99,102,241,0.15); color: #818cf8; }
.news-text { font-size: 13px; line-height: 1.5; color: #d1d5e8; }
.news-time { font-size: 11px; color: var(â€“muted); margin-top: 3px; }

/* Last updated */
.last-updated { text-align: center; font-size: 11px; color: var(â€“muted); margin-bottom: 16px; }

/* Bottom Nav */
.bottom-nav {
position: fixed; bottom: 0; left: 0; right: 0;
background: rgba(13,15,20,0.95); backdrop-filter: blur(20px);
border-top: 1px solid var(â€“border);
display: flex; justify-content: space-around; padding: 10px 0 18px; z-index: 100;
}
.nav-item { display: flex; flex-direction: column; align-items: center; gap: 3px; cursor: pointer; opacity: 0.45; transition: opacity 0.2s; }
.nav-item.active { opacity: 1; }
.nav-icon { font-size: 19px; }
.nav-label { font-size: 10px; font-weight: 600; }
.nav-item.active .nav-label { color: #818cf8; }

/* Fade in */
.fade-in { opacity: 0; transform: translateY(10px); animation: fadeIn 0.4s forwards; }
@keyframes fadeIn { to { opacity: 1; transform: translateY(0); } }
.fade-in:nth-child(1){animation-delay:0.05s}
.fade-in:nth-child(2){animation-delay:0.1s}
.fade-in:nth-child(3){animation-delay:0.15s}
.fade-in:nth-child(4){animation-delay:0.2s}
.fade-in:nth-child(5){animation-delay:0.25s}
.fade-in:nth-child(6){animation-delay:0.3s}
.fade-in:nth-child(7){animation-delay:0.35s}

/* Error toast */
.toast {
position: fixed; bottom: 90px; left: 50%; transform: translateX(-50%);
background: #1e2535; border: 1px solid rgba(255,91,91,0.4);
color: #ffb3b3; font-size: 12px; padding: 10px 16px;
border-radius: 12px; z-index: 999; opacity: 0;
transition: opacity 0.3s; pointer-events: none; white-space: nowrap;
}
.toast.show { opacity: 1; }
</style>

</head>
<body>

<!-- API Key Banner -->

<div class="api-banner">
  <div style="display:flex;align-items:center;gap:6px;flex:1;min-width:0">
    <span id="modeBadge" class="demo-badge">DEMO</span>
    <span class="api-banner-text" id="bannerText"><strong>API í‚¤</strong>ë¥¼ ì…ë ¥í•˜ë©´ ì‹¤ì‹œê°„ ë°ì´í„°ë¡œ ì „í™˜ë¼ìš”</span>
  </div>
  <input class="api-key-input" id="apiKeyInput" placeholder="API í‚¤ ì…ë ¥..." maxlength="50" />
  <button class="api-key-btn" onclick="applyApiKey()">ì ìš©</button>
</div>

<div class="wrap">
  <header class="fade-in">
    <div class="header-date" id="todayDate"></div>
    <h1 class="header-title">ì˜¤ëŠ˜ì˜ <span>ì‹œí™© ë¸Œë¦¬í•‘</span></h1>
    <p class="header-sub" id="headerSub">ë°ëª¨ ë°ì´í„°ë¡œ í‘œì‹œ ì¤‘ Â· API í‚¤ ì…ë ¥ ì‹œ ì‹¤ì‹œê°„ ì „í™˜</p>
  </header>

  <!-- AI ìš”ì•½ -->

  <div class="summary-card fade-in">
    <div class="summary-label"><div class="ai-dot"></div>AI ë¸Œë¦¬í•‘ ìš”ì•½</div>
    <p class="summary-text" id="summaryText">
      ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ì´ì—ìš”...
    </p>
  </div>

  <!-- ë¯¸êµ­ ì£¼ìš” ì§€ìˆ˜ -->

  <div class="fade-in">
    <div class="section-header">
      <div class="section-title">ë¯¸êµ­ ì§€ìˆ˜</div>
      <button class="refresh-btn" onclick="loadMarketData()"><span id="refreshIcon">â†»</span> ìƒˆë¡œê³ ì¹¨</button>
    </div>
    <div class="index-row" id="usIndexRow">
      <div class="index-card">
        <div class="index-name">ë‚˜ìŠ¤ë‹¥</div>
        <div class="index-value skeleton" style="height:28px;width:100px;margin-bottom:6px"></div>
        <div class="skeleton" style="height:16px;width:120px"></div>
        <div class="loading-bar skeleton"></div>
      </div>
      <div class="index-card">
        <div class="index-name">S&amp;P 500</div>
        <div class="index-value skeleton" style="height:28px;width:100px;margin-bottom:6px"></div>
        <div class="skeleton" style="height:16px;width:120px"></div>
        <div class="loading-bar skeleton"></div>
      </div>
    </div>
  </div>

  <!-- êµ­ë‚´ ì§€ìˆ˜ -->

  <div class="fade-in">
    <div class="section-header">
      <div class="section-title">êµ­ë‚´ ì§€ìˆ˜</div>
    </div>
    <div class="index-row" id="krIndexRow">
      <div class="index-card">
        <div class="index-name">KOSPI</div>
        <div class="index-value skeleton" style="height:28px;width:100px;margin-bottom:6px"></div>
        <div class="skeleton" style="height:16px;width:120px"></div>
        <div class="loading-bar skeleton"></div>
      </div>
      <div class="index-card">
        <div class="index-name">KOSDAQ</div>
        <div class="index-value skeleton" style="height:28px;width:100px;margin-bottom:6px"></div>
        <div class="skeleton" style="height:16px;width:120px"></div>
        <div class="loading-bar skeleton"></div>
      </div>
    </div>
  </div>

  <!-- í™˜ìœ¨ / ê¸ˆë¦¬ -->

  <div class="fade-in">
    <div class="section-header"><div class="section-title">í™˜ìœ¨ Â· ê¸ˆë¦¬</div></div>
    <div class="fx-row" id="fxRow">
      <div class="fx-card"><div class="fx-label">USD/KRW</div><div class="skeleton" style="height:22px;margin:4px 0"></div><div class="skeleton" style="height:14px;width:60%;margin:0 auto"></div></div>
      <div class="fx-card"><div class="fx-label">ê¸°ì¤€ê¸ˆë¦¬</div><div class="skeleton" style="height:22px;margin:4px 0"></div><div class="skeleton" style="height:14px;width:60%;margin:0 auto"></div></div>
      <div class="fx-card"><div class="fx-label">êµ­ê³ ì±„ 3Y</div><div class="skeleton" style="height:22px;margin:4px 0"></div><div class="skeleton" style="height:14px;width:60%;margin:0 auto"></div></div>
    </div>
  </div>

  <!-- ë¶€ë™ì‚° -->

  <div class="fade-in">
    <div class="section-header"><div class="section-title">ë¶€ë™ì‚° ì‹œí™©</div><span style="font-size:11px;color:var(--muted)">KBë¶€ë™ì‚° ê¸°ì¤€</span></div>
    <div class="re-grid" id="reGrid">
      <div class="re-card"><div class="re-region">ì„œìš¸</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
      <div class="re-card"><div class="re-region">ê²½ê¸°</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
      <div class="re-card"><div class="re-region">ì¸ì²œ</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
      <div class="re-card"><div class="re-region">ë¶€ì‚°</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
      <div class="re-card"><div class="re-region">ì „ì„¸</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
      <div class="re-card"><div class="re-region">ê±°ë˜ëŸ‰</div><div class="skeleton" style="height:20px;margin:4px 0"></div><div class="skeleton" style="height:13px;width:70%;margin:0 auto"></div></div>
    </div>
  </div>

  <!-- ì¸ê¸° ì¢…ëª© -->

  <div class="fade-in">
    <div class="section-header"><div class="section-title">ì£¼ëª© ì¢…ëª©</div></div>
    <div class="stock-list" id="stockList">
      <div class="stock-item" style="gap:8px">
        <div class="skeleton" style="width:34px;height:34px;border-radius:10px;margin:0 10px 0 18px;flex-shrink:0"></div>
        <div style="flex:1"><div class="skeleton" style="height:14px;width:80px;margin-bottom:6px"></div><div class="skeleton" style="height:12px;width:50px"></div></div>
        <div><div class="skeleton" style="height:14px;width:70px;margin-bottom:6px"></div><div class="skeleton" style="height:12px;width:60px"></div></div>
      </div>
      <div class="stock-item" style="gap:8px">
        <div class="skeleton" style="width:34px;height:34px;border-radius:10px;margin:0 10px 0 18px;flex-shrink:0"></div>
        <div style="flex:1"><div class="skeleton" style="height:14px;width:80px;margin-bottom:6px"></div><div class="skeleton" style="height:12px;width:50px"></div></div>
        <div><div class="skeleton" style="height:14px;width:70px;margin-bottom:6px"></div><div class="skeleton" style="height:12px;width:60px"></div></div>
      </div>
    </div>
  </div>

  <!-- ì£¼ìš” ë‰´ìŠ¤ -->

  <div class="fade-in">
    <div class="section-header"><div class="section-title">ì£¼ìš” ë‰´ìŠ¤</div></div>
    <div class="news-list" id="newsList">
      <div class="news-item"><div class="skeleton" style="height:14px;width:100%"></div></div>
      <div class="news-item"><div class="skeleton" style="height:14px;width:100%"></div></div>
    </div>
  </div>

  <div class="last-updated" id="lastUpdated"></div>
</div>

<!-- Toast -->

<div class="toast" id="toast"></div>

<!-- Bottom Nav -->

<nav class="bottom-nav">
  <div class="nav-item active"><div class="nav-icon">ğŸ“Š</div><div class="nav-label">ì‹œí™©</div></div>
  <div class="nav-item"><div class="nav-icon">ğŸ </div><div class="nav-label">ë¶€ë™ì‚°</div></div>
  <div class="nav-item"><div class="nav-icon">ğŸ“ˆ</div><div class="nav-label">ì£¼ì‹</div></div>
  <div class="nav-item"><div class="nav-icon">ğŸ’±</div><div class="nav-label">í™˜ìœ¨</div></div>
  <div class="nav-item"><div class="nav-icon">âš™ï¸</div><div class="nav-label">ì„¤ì •</div></div>
</nav>

<script>
// â”€â”€â”€ ìƒíƒœ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
let API_KEY = '';
let isLive = false;

// â”€â”€â”€ ë‚ ì§œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const now = new Date();
const DAYS = ['ì¼','ì›”','í™”','ìˆ˜','ëª©','ê¸ˆ','í† '];
document.getElementById('todayDate').textContent =
  `${now.getFullYear()}ë…„ ${now.getMonth()+1}ì›” ${now.getDate()}ì¼ (${DAYS[now.getDay()]})`;

// â”€â”€â”€ í† ìŠ¤íŠ¸ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function showToast(msg, duration = 3000) {
  const t = document.getElementById('toast');
  t.textContent = msg;
  t.classList.add('show');
  setTimeout(() => t.classList.remove('show'), duration);
}

// â”€â”€â”€ API í‚¤ ì ìš© â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function applyApiKey() {
  const key = document.getElementById('apiKeyInput').value.trim();
  if (!key) { showToast('âš ï¸ API í‚¤ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'); return; }
  if (key.length < 10) { showToast('âš ï¸ API í‚¤ê°€ ë„ˆë¬´ ì§§ì•„ìš”. ë‹¤ì‹œ í™•ì¸í•´ì£¼ì„¸ìš”'); return; }
  API_KEY = key;
  isLive = true;
  document.getElementById('modeBadge').className = 'live-badge';
  document.getElementById('modeBadge').style.display = 'inline-block';
  document.getElementById('modeBadge').textContent = 'â— LIVE';
  document.querySelector('.demo-badge') && (document.querySelector('.demo-badge').style.display = 'none');
  document.getElementById('bannerText').innerHTML = '<strong>ì‹¤ì‹œê°„ ë°ì´í„°</strong> ì—°ë™ë¨ Â· Alpha Vantage';
  document.getElementById('headerSub').textContent = 'ì‹¤ì‹œê°„ ë°ì´í„° Â· Alpha Vantage';
  showToast('âœ… API í‚¤ ì ìš©ë¨! ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...', 2000);
  loadMarketData();
}

// â”€â”€â”€ ë¯¸ë‹ˆ ì°¨íŠ¸ SVG â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function miniChart(points, isUp) {
  const color = isUp ? '#ff5b5b' : '#4c8ef7';
  const gradId = 'g' + Math.random().toString(36).substr(2,5);
  const min = Math.min(...points), max = Math.max(...points);
  const range = max - min || 1;
  const w = 100, h = 30;
  const pts = points.map((v, i) => {
    const x = (i / (points.length - 1)) * w;
    const y = h - ((v - min) / range) * (h - 4) - 2;
    return `${x},${y}`;
  }).join(' ');
  return `<svg class="mini-chart" viewBox="0 0 100 30" preserveAspectRatio="none">
    <defs><linearGradient id="${gradId}" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="${color}" stop-opacity="0.2"/>
      <stop offset="100%" stop-color="${color}" stop-opacity="0"/>
    </linearGradient></defs>
    <polyline points="${pts}" fill="none" stroke="${color}" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
    <polyline points="${pts} 100,30 0,30" fill="url(#${gradId})" stroke="none"/>
  </svg>`;
}

// â”€â”€â”€ ëœë¤ ì°¨íŠ¸ í¬ì¸íŠ¸ ìƒì„± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function randomPoints(base, volatility, count = 12, trend = 0) {
  const pts = [base];
  for (let i = 1; i < count; i++) {
    const prev = pts[i-1];
    const change = (Math.random() - 0.48) * volatility + trend;
    pts.push(Math.max(prev + change, base * 0.9));
  }
  return pts;
}

// â”€â”€â”€ ë°ëª¨ ë°ì´í„° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const DEMO_DATA = {
  nasdaq: { value: '17,845.12', change: '-124.56', pct: '-0.69', up: false },
  sp500:  { value: '5,012.34',  change: '+18.90',  pct: '+0.38', up: true  },
  kospi:  { value: '2,631.46',  change: '+12.34',  pct: '+0.47', up: true  },
  kosdaq: { value: '851.24',    change: '-3.21',   pct: '-0.38', up: false },
  fx: { usd: '1,342', rate: '3.50%', bond: '3.28%',
        usdChg: '-3.2ì›', rateChg: 'ë™ê²°', bondChg: 'â–² 0.02%p',
        usdUp: true, rateUp: false, bondUp: true },
  stocks: [
    { rank:1, name:'ì‚¼ì„±ì „ì', ticker:'005930', icon:'ì‚¼', color:'#ff5b5b', price:'74,800ì›', change:'+800 (+1.08%)', up:true },
    { rank:2, name:'SKí•˜ì´ë‹‰ìŠ¤', ticker:'000660', icon:'SK', color:'#4c8ef7', price:'198,500ì›', change:'-1,500 (-0.75%)', up:false },
    { rank:3, name:'NVIDIA', ticker:'NVDA', icon:'NV', color:'#f59e0b', price:'$875.40', change:'+12.30 (+1.42%)', up:true },
    { rank:4, name:'Apple', ticker:'AAPL', icon:'ğŸ', color:'#818cf8', price:'$182.40', change:'-2.10 (-1.14%)', up:false },
  ],
  news: [
    { tag:'ì£¼ì‹', tagClass:'tag-blue', text:'ì—°ì¤€ ìœ„ì› "ê¸ˆë¦¬ ì¸í•˜ ì„œë‘ë¥´ì§€ ì•Šê² ë‹¤"... ë‚˜ìŠ¤ë‹¥ ê¸°ìˆ ì£¼ ì¤‘ì‹¬ ì¡°ì •', time:'30ë¶„ ì „' },
    { tag:'ë¶€ë™ì‚°', tagClass:'tag-red', text:'ì„œìš¸ ì•„íŒŒíŠ¸ ë§¤ë§¤ 3ì£¼ ì—°ì† ë³´í•©... ê°•ë‚¨3êµ¬ ê±°ë˜ëŸ‰ ì†Œí­ íšŒë³µì„¸', time:'1ì‹œê°„ ì „' },
    { tag:'í™˜ìœ¨', tagClass:'tag-gold', text:'ì›Â·ë‹¬ëŸ¬ 1,340ì›ëŒ€ ì§„ì…... ì™¸êµ­ì¸ ì½”ìŠ¤í”¼ ìˆœë§¤ìˆ˜ ì˜í–¥', time:'2ì‹œê°„ ì „' },
    { tag:'ë°˜ë„ì²´', tagClass:'tag-purple', text:'ì‚¼ì„±ì „ì HBM4 ì–‘ì‚° ì¼ì • ì•ë‹¹ê²¨... í•˜ë°˜ê¸° ì‹¤ì  ê¸°ëŒ€ê° ìƒìŠ¹', time:'3ì‹œê°„ ì „' },
  ],
  re: [
    { region:'ì„œìš¸', value:'+0.02%', sub:'ë§¤ë§¤ ë³´í•©', up:true },
    { region:'ê²½ê¸°', value:'-0.03%', sub:'ì†Œí­ í•˜ë½', up:false },
    { region:'ì¸ì²œ', value:'-0.01%', sub:'ë³´í•©', up:false },
    { region:'ë¶€ì‚°', value:'+0.04%', sub:'ì†Œí­ ìƒìŠ¹', up:true },
    { region:'ì „ì„¸', value:'+0.01%', sub:'ì„œìš¸ ê¸°ì¤€', up:true },
    { region:'ê±°ë˜ëŸ‰', value:'2,341ê±´', sub:'ì „ì£¼æ¯” â†‘12%', up:true },
  ],
  summary: `ì˜¤ëŠ˜ <strong>ë‚˜ìŠ¤ë‹¥ì€ ì—°ì¤€ ìœ„ì›ì˜ ë§¤íŒŒ ë°œì–¸ ì´í›„ ê¸°ìˆ ì£¼ ì¤‘ì‹¬ìœ¼ë¡œ ì¡°ì •</strong>ì„ ë°›ì•˜ì–´ìš”. ë°˜ë©´ <strong>S&P 500ì€ ì†Œí­ ë°˜ë“±</strong>ì— ì„±ê³µí–ˆìŠµë‹ˆë‹¤. êµ­ë‚´ì—ì„œëŠ” ì½”ìŠ¤í”¼ê°€ ì™¸êµ­ì¸ ìˆœë§¤ìˆ˜ë¡œ ê°•ì„¸ë¥¼ ë³´ì´ê³  ìˆì–´ìš”. <strong>ì›Â·ë‹¬ëŸ¬ í™˜ìœ¨ì€ 1,342ì›</strong>ìœ¼ë¡œ ì†Œí­ ê°•ì„¸ë¥¼ ìœ ì§€ ì¤‘ì´ë©°, ë¶€ë™ì‚° ì‹œì¥ì€ ì„œìš¸ì„ ì¤‘ì‹¬ìœ¼ë¡œ <strong>3ì£¼ ì—°ì† ë³´í•©ì„¸</strong>ê°€ ì´ì–´ì§€ê³  ìˆì–´ìš”.`
};

// â”€â”€â”€ Alpha Vantageì—ì„œ ì‹¤ì œ ë°ì´í„° ê°€ì ¸ì˜¤ê¸° â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function fetchQuote(symbol) {
  const url = `https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${symbol}&apikey=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();
  const q = data['Global Quote'];
  if (!q || !q['05. price']) throw new Error('ë°ì´í„° ì—†ìŒ: ' + symbol);
  return {
    price: parseFloat(q['05. price']),
    change: parseFloat(q['09. change']),
    pct: parseFloat(q['10. change percent'].replace('%','')),
  };
}

async function fetchFX() {
  const url = `https://www.alphavantage.co/query?function=CURRENCY_EXCHANGE_RATE&from_currency=USD&to_currency=KRW&apikey=${API_KEY}`;
  const res = await fetch(url);
  const data = await res.json();
  const rate = data['Realtime Currency Exchange Rate'];
  if (!rate) throw new Error('í™˜ìœ¨ ë°ì´í„° ì—†ìŒ');
  return parseFloat(rate['5. Exchange Rate']);
}

// â”€â”€â”€ UI ë Œë” í•¨ìˆ˜ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function renderIndexCard(name, d, chartPts) {
  const arrow = d.up ? 'â–²' : 'â–¼';
  const cls = d.up ? 'up' : 'down';
  return `<div class="index-card">
    <div class="index-name">${name}</div>
    <div class="index-value">${d.value}</div>
    <div class="index-change ${cls}">${arrow} ${d.change} (${d.pct}%)</div>
    ${miniChart(chartPts, d.up)}
  </div>`;
}

function renderFX(d) {
  return `
  <div class="fx-card">
    <div class="fx-label">USD/KRW</div>
    <div class="fx-value">${d.usd}</div>
    <div class="fx-change ${d.usdUp ? 'down' : 'up'}">${d.usdChg}</div>
  </div>
  <div class="fx-card">
    <div class="fx-label">ê¸°ì¤€ê¸ˆë¦¬</div>
    <div class="fx-value">${d.rate}</div>
    <div class="fx-change neutral-c">${d.rateChg}</div>
  </div>
  <div class="fx-card">
    <div class="fx-label">êµ­ê³ ì±„ 3Y</div>
    <div class="fx-value">${d.bond}</div>
    <div class="fx-change ${d.bondUp ? 'up' : 'down'}">${d.bondChg}</div>
  </div>`;
}

function renderStocks(stocks) {
  return stocks.map(s => `
  <div class="stock-item">
    <div class="stock-rank">${s.rank}</div>
    <div class="stock-icon" style="background:${s.color}22;color:${s.color}">${s.icon}</div>
    <div class="stock-info">
      <div class="stock-name">${s.name}</div>
      <div class="stock-ticker">${s.ticker}</div>
    </div>
    <div class="stock-price-wrap">
      <div class="stock-price">${s.price}</div>
      <div class="stock-change ${s.up ? 'up' : 'down'}">${s.change}</div>
    </div>
  </div>`).join('');
}

function renderNews(news) {
  return news.map(n => `
  <div class="news-item">
    <div class="news-tag ${n.tagClass}">${n.tag}</div>
    <div>
      <div class="news-text">${n.text}</div>
      <div class="news-time">${n.time}</div>
    </div>
  </div>`).join('');
}

function renderRE(re) {
  return re.map(r => `
  <div class="re-card">
    <div class="re-region">${r.region}</div>
    <div class="re-value ${r.region === 'ê±°ë˜ëŸ‰' ? 'neutral-c' : (r.up ? 'up' : 'down')}" style="font-size:${r.region==='ê±°ë˜ëŸ‰'?'13px':'15px'}">${r.value}</div>
    <div class="re-sub ${r.up ? 'up' : 'neutral-c'}">${r.sub}</div>
  </div>`).join('');
}

// â”€â”€â”€ ë©”ì¸ ë°ì´í„° ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
async function loadMarketData() {
  const icon = document.getElementById('refreshIcon');
  icon.classList.add('spin');

  try {
    if (isLive && API_KEY) {
      // â”€â”€ ì‹¤ì œ API í˜¸ì¶œ â”€â”€
      let nasdaqData, sp500Data, fxData;

      try {
        const [nasdaq, sp500, fx] = await Promise.all([
          fetchQuote('QQQ'),   // ë‚˜ìŠ¤ë‹¥ ETF
          fetchQuote('SPY'),   // S&P500 ETF
          fetchFX(),
        ]);
        nasdaqData = nasdaq;
        sp500Data = sp500;
        fxData = fx;
      } catch(e) {
        showToast('âš ï¸ API í•œë„ ì´ˆê³¼ ë˜ëŠ” ì˜¤ë¥˜ - ë°ëª¨ ëª¨ë“œë¡œ í‘œì‹œí•©ë‹ˆë‹¤', 4000);
        isLive = false;
        renderAll(DEMO_DATA);
        icon.classList.remove('spin');
        return;
      }

      const fmtPrice = (v) => v.toLocaleString('en-US', {minimumFractionDigits:2,maximumFractionDigits:2});
      const fmtChg = (v, up) => `${up?'+':''}${v.toFixed(2)}`;

      const live = {
        ...DEMO_DATA,
        nasdaq: {
          value: '$' + fmtPrice(nasdaqData.price),
          change: fmtChg(nasdaqData.change, nasdaqData.change > 0),
          pct: (nasdaqData.change > 0 ? '+' : '') + nasdaqData.pct.toFixed(2),
          up: nasdaqData.change > 0
        },
        sp500: {
          value: '$' + fmtPrice(sp500Data.price),
          change: fmtChg(sp500Data.change, sp500Data.change > 0),
          pct: (sp500Data.change > 0 ? '+' : '') + sp500Data.pct.toFixed(2),
          up: sp500Data.change > 0
        },
        fx: {
          ...DEMO_DATA.fx,
          usd: Math.round(fxData).toLocaleString(),
          usdChg: fxData > 1340 ? `+${(fxData - 1340).toFixed(0)}ì›` : `${(fxData - 1340).toFixed(0)}ì›`,
          usdUp: fxData < 1340,
        }
      };
      renderAll(live);
    } else {
      // â”€â”€ ë°ëª¨ ëª¨ë“œ â”€â”€
      await new Promise(r => setTimeout(r, 800)); // ë¡œë”© íš¨ê³¼
      renderAll(DEMO_DATA);
    }

    const now = new Date();
    document.getElementById('lastUpdated').textContent =
      `ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸: ${now.getHours()}:${String(now.getMinutes()).padStart(2,'0')}:${String(now.getSeconds()).padStart(2,'0')}`;

  } catch(err) {
    showToast('âŒ ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ì‹¤íŒ¨. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.', 3000);
  } finally {
    icon.classList.remove('spin');
  }
}

function renderAll(d) {
  const nasdaqPts = randomPoints(100, 2, 14, d.nasdaq.up ? 0.3 : -0.3);
  const sp500Pts  = randomPoints(100, 1.5, 14, d.sp500.up ? 0.3 : -0.3);
  const kospiPts  = randomPoints(100, 1.8, 14, d.kospi.up ? 0.3 : -0.3);
  const kosdaqPts = randomPoints(100, 2.2, 14, d.kosdaq.up ? 0.3 : -0.3);

  document.getElementById('usIndexRow').innerHTML =
    renderIndexCard('ë‚˜ìŠ¤ë‹¥ (QQQ)', d.nasdaq, nasdaqPts) +
    renderIndexCard('S&amp;P 500 (SPY)', d.sp500, sp500Pts);

  document.getElementById('krIndexRow').innerHTML =
    renderIndexCard('KOSPI', d.kospi, kospiPts) +
    renderIndexCard('KOSDAQ', d.kosdaq, kosdaqPts);

  document.getElementById('fxRow').innerHTML = renderFX(d.fx);
  document.getElementById('reGrid').innerHTML = renderRE(d.re);
  document.getElementById('stockList').innerHTML = renderStocks(d.stocks);
  document.getElementById('newsList').innerHTML = renderNews(d.news);
  document.getElementById('summaryText').innerHTML = d.summary;
}

// â”€â”€â”€ ì´ˆê¸° ë¡œë“œ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
loadMarketData();

// â”€â”€â”€ 5ë¶„ë§ˆë‹¤ ìë™ ê°±ì‹  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
setInterval(() => { if (isLive) loadMarketData(); }, 5 * 60 * 1000);
</script>

</body>
</html>
